<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" id="viewport" content="width=device-width, user-scalable=no, minimum-scale=1, maximum-scale=1">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<title>3D180</title>
		<link type="text/css" rel="stylesheet" href="style.css" />

	</head>

	<body>
		<script src="build/three.min.js"></script>
		<script src="build/jquery-1.8.0.min.js"></script>
		<script src="build/TweenMax.min.js"></script>

		<script src="js/Detector.js"></script>
		<script src="js/libs/stats.min.js"></script>
		<script src="js/controls/OrbitControls.js"></script>

		<script id="vertexShader" type="x-shader/x-vertex">
			precision highp float;
			uniform float sineTime;
			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;
			attribute vec3 position;
			attribute vec3 offset;
			attribute vec4 color;
			attribute vec4 orientationStart;
			attribute vec4 orientationEnd;
			varying vec3 vPosition;
			varying vec4 vColor;
			void main(){
				vPosition = offset * max(abs(sineTime * 2.0 + 1.0), 0.5) + position;
				vec4 orientation = normalize(mix(orientationStart, orientationEnd, sineTime));
				vec3 vcV = cross(orientation.xyz, vPosition);
				vPosition = vcV * (2.0 * orientation.w) + (cross(orientation.xyz, vcV) * 2.0 + vPosition);
				vColor = color;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( vPosition, 1.0 );
			}
		</script>

		<script id="fragmentShader" type="x-shader/x-fragment">
			precision highp float;
			uniform float time;
			varying vec3 vPosition;
			varying vec4 vColor;
			void main() {
				vec4 color = vec4( vColor );
				color.r += sin( vPosition.x * 10.0 + time ) * 0.5;
				gl_FragColor = color;
			}
		</script>


		<script type="x-shader/x-vertex" id="vertexshader">
			uniform float amplitude;
			attribute float displacement;
			varying vec3 vNormal;
			varying vec2 vUv;
			void main() {
				vNormal = normal;
				vUv = ( 0.5 + amplitude ) * uv + vec2( amplitude );
				vec3 newPosition = position + amplitude * normal * vec3( displacement );
				gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );
			}
		</script>

		<script type="x-shader/x-fragment" id="fragmentshader">
			varying vec3 vNormal;
			varying vec2 vUv;
			uniform vec3 color;
			uniform sampler2D texture;
			void main() {
				vec3 light = vec3( 0.5, 0.2, 1.0 );
				light = normalize( light );
				float dProd = dot( vNormal, light ) * 0.5 + 0.5;
				vec4 tcolor = texture2D( texture, vUv );
				vec4 gray = vec4( vec3( tcolor.r * 0.3 + tcolor.g * 0.59 + tcolor.b * 0.11 ), 1.0 );
				gl_FragColor = gray * vec4( vec3( dProd ) * vec3( color ), 1.0 );
			}
		</script>

	    <script src="main.js"></script>
	</body>
</html>
