<html>

<head>
<title>DeviceOrientationEvent</title>
<meta charset="UTF-8" />
</head>

<body>
<p>Z轴(左右)：<span id="alpha">0</span>
</p>
<p>X轴(前后)：<span id="beta">0</span>
</p>
<p>Y轴(扭转)：<span id="gamma">0</span>
</p>
<p>指北针指向：<span id="heading">0</span>度</p>
<p>指北针精度：<span id="accuracy">0</span>度</p>
<hr />
<p>X轴加速度：<span id="x">0</span>m/s2</p>
<p>Y轴加速度：<span id="y">0</span>m/s2</p>
<p>Z轴加速度：<span id="z">0</span>m/s2</p>
<hr />
<p>X轴加速度(考虑重力加速度)：<span id="xg">0</span>m/s2</p>
<p>Y轴加速度(考虑重力加速度)：<span id="yg">0</span>m/s2</p>
<p>Z轴加速度(考虑重力加速度)：<span id="zg">0</span>m/s2</p>
<hr />
<p>Z轴旋转速度(左右)：<span id="Ralpha">0</span>度每秒</p>
<p>X轴旋转速度(前后)：<span id="Rbeta">0</span>度每秒</p>
<p>Y轴扭转速度(扭转)：<span id="Rgamma">0</span>度每秒</p>
<hr />
<p>上次收到通知的间隔：<span id="interval">0</span>毫秒</p>

<img src="http://www.changewater.cn/Gravity.png" alt=""/>


<script type="text/javascript">
function orientationHandler(event) {
	document.getElementById("alpha").innerHTML = event.alpha;
	document.getElementById("beta").innerHTML = event.beta;
	document.getElementById("gamma").innerHTML = event.gamma;
	document.getElementById("heading").innerHTML = event.webkitCompassHeading;
	document.getElementById("accuracy").innerHTML = event.webkitCompassAccuracy;

}


var last_update = 0;  
var x = y = z = last_x = last_y = last_z = 0;  

function motionHandler(event) {
	document.getElementById("interval").innerHTML = event.interval;
	var acc = event.acceleration;
	document.getElementById("x").innerHTML = acc.x;
	document.getElementById("y").innerHTML = acc.y;
	document.getElementById("z").innerHTML = acc.z;
	var accGravity = event.accelerationIncludingGravity;
	document.getElementById("xg").innerHTML = accGravity.x;
	document.getElementById("yg").innerHTML = accGravity.y;
	document.getElementById("zg").innerHTML = accGravity.z;
	var rotationRate = event.rotationRate;
	document.getElementById("Ralpha").innerHTML = rotationRate.alpha;
	document.getElementById("Rbeta").innerHTML = rotationRate.beta;
	document.getElementById("Rgamma").innerHTML = rotationRate.gamma;



    var curTime = new Date().getTime();  
    if ((curTime - last_update) > 100) {  
        var diffTime = curTime - last_update;  
        last_update = curTime;  
        x = accGravity.x;  
        y = accGravity.y;  
        z = accGravity.z;  
        var speed = Math.abs(x + y + z - last_x - last_y - last_z) / diffTime * 10000;  

        if (speed > 2000) {  
            // alert("摇动了");  
            speed = 0;
        }  
        last_x = x;  
        last_y = y;  
        last_z = z;  
    }
}

if (window.DeviceMotionEvent) {
	window.addEventListener("devicemotion", motionHandler, false);
} else {
	document.body.innerHTML = "What user agent u r using???";
}

if (window.DeviceOrientationEvent) {
	window.addEventListener("deviceorientation", orientationHandler, false);
} else {
	document.body.innerHTML = "What user agent u r using???";
};



function getForce(e)
{
    var hasGravity = (e.acceleration && true);
    var acc = e.acceleration || e.accelerationIncludingGravity;
    var total = acc.x + acc.y + acc.z;
    if (hasGravity)
    {
        return total * 140;
    }
    else
    {
        return (window.orientation < 0 ? total - 10 : total + 10) * 140;
    }
}


</script>
</body>

</html>